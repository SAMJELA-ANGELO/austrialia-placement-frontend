<template>
  <div class="" id="content">
    <nav class="relative">
      <div class="py-6 shape border-b grid grid-cols-2 md:grid-cols-4 bg-white">
        <a class="text-2xl text-white font-semibold" href="/home">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="151"
            height="46"
            viewBox="0 0 151 46"
            fill="none"
          >
            <path
              d="M50.2136 32.8061H59.103C63.7762 32.8061 66.2652 30.3679 66.2652 27.056C66.2652 23.9778 64.0607 22.1186 61.6936 22.0069V21.8037C63.8575 21.316 65.4525 19.782 65.4525 17.3336C65.4525 14.2147 63.1362 12 58.5442 12H50.2136V32.8061ZM54.6126 29.2098V23.6831H58.3004C60.4135 23.6831 61.7241 24.9022 61.7241 26.6192C61.7241 28.1837 60.6573 29.2098 58.1988 29.2098H54.6126ZM54.6126 20.7065V15.5557H57.955C59.9055 15.5557 61.0129 16.5615 61.0129 18.0651C61.0129 19.7109 59.6719 20.7065 57.8737 20.7065H54.6126Z"
              fill="#8CB7F5"
            />
            <path
              d="M68.5182 32.8061H72.846V23.9778C72.846 22.0577 74.248 20.737 76.1579 20.737C76.7573 20.737 77.5802 20.8385 77.9866 20.9706V17.1304C77.6005 17.039 77.0621 16.978 76.6253 16.978C74.8779 16.978 73.4454 17.994 72.8765 19.9242H72.7139V17.2015H68.5182V32.8061Z"
              fill="#8CB7F5"
            />
            <path
              d="M83.6988 33.1008C86.0049 33.1008 87.4983 32.095 88.2603 30.6422H88.3822V32.8061H92.4865V22.2812C92.4865 18.5629 89.3371 16.9984 85.8627 16.9984C82.1241 16.9984 79.6655 18.7864 79.0661 21.631L83.0689 21.9561C83.3635 20.9198 84.288 20.1579 85.8424 20.1579C87.3155 20.1579 88.1587 20.8995 88.1587 22.1796V22.2405C88.1587 23.2463 87.092 23.3784 84.3794 23.6425C81.291 23.927 78.5175 24.9632 78.5175 28.4478C78.5175 31.5362 80.7221 33.1008 83.6988 33.1008ZM84.9382 30.1139C83.6073 30.1139 82.6524 29.4942 82.6524 28.3056C82.6524 27.0865 83.6581 26.4871 85.182 26.2737C86.1268 26.1417 87.671 25.9182 88.1891 25.5728V27.2287C88.1891 28.8644 86.838 30.1139 84.9382 30.1139Z"
              fill="#8CB7F5"
            />
            <path
              d="M99.6438 23.7847C99.654 21.7732 100.853 20.5947 102.6 20.5947C104.337 20.5947 105.384 21.7326 105.374 23.6425V32.8061H109.701V22.8704C109.701 19.2334 107.568 16.9984 104.317 16.9984C102.001 16.9984 100.324 18.1362 99.6235 19.9547H99.4406V17.2015H95.316V32.8061H99.6438V23.7847Z"
              fill="#8CB7F5"
            />
            <path
              d="M118.334 33.0601C120.854 33.0601 122.164 31.6074 122.764 30.307H122.947V32.8061H127.214V12H122.896V19.8226H122.764C122.185 18.5527 120.935 16.9984 118.324 16.9984C114.901 16.9984 112.005 19.6601 112.005 25.0242C112.005 30.246 114.779 33.0601 118.334 33.0601ZM119.706 29.6161C117.583 29.6161 116.424 27.7265 116.424 25.0038C116.424 22.3015 117.562 20.4423 119.706 20.4423C121.809 20.4423 122.987 22.2202 122.987 25.0038C122.987 27.7875 121.789 29.6161 119.706 29.6161Z"
              fill="#8CB7F5"
            />
            <g opacity="0.8">
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M14.4674 2.91309H37.1848C40.9487 2.91309 44 6.28555 44 10.4457V35.5544C44 39.7145 40.9487 43.087 37.1848 43.087H14.4674C10.7034 43.087 7.65216 39.7145 7.65216 35.5544L7.65216 10.4457C7.65216 6.28555 10.7034 2.91309 14.4674 2.91309Z"
                fill="#0D6EFD"
                fill-opacity="0.2"
              />
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M8.13044 2.91309H32.0435C36.0055 2.91309 39.2174 6.28555 39.2174 10.4457V35.5544C39.2174 39.7145 36.0055 43.087 32.0435 43.087H8.13044C4.1684 43.087 0.956527 39.7145 0.956528 35.5544L0.956528 10.4457C0.956527 6.28555 4.1684 2.91309 8.13044 2.91309Z"
                fill="#0D6EFD"
              />
              <g opacity="0.7">
                <path
                  opacity="0.3"
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M15.2902 19.3562H14.3097C14.2591 19.3562 14.1842 19.4265 14.1813 19.473L13.4589 31.1476L26.9548 31.1451L26.2253 19.473C26.2225 19.4283 26.1457 19.3562 26.0969 19.3562H25.1164V21.3214C25.1164 21.8641 24.6765 22.3041 24.1338 22.3041C23.5911 22.3041 23.1512 21.8641 23.1512 21.3214V19.3562H17.2554V21.3214C17.2554 21.8641 16.8155 22.3041 16.2728 22.3041C15.7301 22.3041 15.2902 21.8641 15.2902 21.3214V19.3562Z"
                  fill="white"
                />
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M20.2033 12.4783C22.9153 12.4783 25.1164 14.6796 25.1164 17.3891L26.0969 17.3914C27.1835 17.3914 28.1192 18.2704 28.1867 19.3508L28.9244 31.1539C28.9921 32.2361 28.1698 33.1133 27.0865 33.1133H13.3201C12.2374 33.1133 11.4146 32.2344 11.4821 31.1539L12.2198 19.3508C12.2875 18.2686 13.2213 17.3914 14.3096 17.3914H15.2902C15.2902 14.6781 17.493 12.4783 20.2033 12.4783ZM23.1511 17.3915C23.1511 15.765 21.8299 14.4436 20.2033 14.4436C18.5778 14.4436 17.2554 15.7642 17.2554 17.3892L23.1511 17.3915ZM15.2902 19.3566H14.3096C14.2591 19.3566 14.1842 19.4269 14.1813 19.4733L13.4589 31.148L26.9548 31.1455L26.2253 19.4733C26.2225 19.4286 26.1457 19.3566 26.0969 19.3566H25.1164V21.3218C25.1164 21.8645 24.6765 22.3044 24.1338 22.3044C23.5911 22.3044 23.1512 21.8645 23.1512 21.3218V19.3566H17.2554V21.3218C17.2554 21.8645 16.8155 22.3044 16.2728 22.3044C15.7301 22.3044 15.2902 21.8645 15.2902 21.3218V19.3566Z"
                  fill="white"
                />
              </g>
            </g>
          </svg>
        </a>
        <div class="hidden col-span-2 xl:flex items-center justify-center">
          <div class="relative w-full rounded-md shadow-sm">
            <input
              type="text"
              name="search"
              id="searchInput"
              class="block w-full rounded-md border-0 py-2.5 pl-7 pr-20 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-1 focus:ring-inset focus:ring-transparent sm:text-md sm:leading-6"
              placeholder="search"
            />
            <div class="absolute inset-y-0 right-0 flex items-center">
              <button
                @click="toggleCategories"
                id="dropdownDefaultButton"
                data-dropdown-toggle="dropdown"
                class="text-gray-600 bg-white focus:ring-1 focus:outline-none border-l focus:ring-green-500 font-medium text-sm px-4 py-2.5 text-center inline-flex items-center"
                type="button"
              >
                All category
                <svg
                  class="w-4 h-4 ml-2"
                  aria-hidden="true"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 9l-7 7-7-7"
                  ></path>
                </svg>
              </button>
              <button
                class="text-white primary focus:ring-1 focus:outline-none border-l focus:ring-green-500 font-medium rounded-r-md text-sm px-6 py-3 text-center inline-flex items-center"
                type="button"
              >
                Search
              </button>
            </div>
          </div>
        </div>
        <div class="flex lg:flex justify-end items-center">
          <Button
            label="Login/Register"
            size="small"
            severity="warning"
            class="login-register"
            outlined
            :hidden="userData"
            @click.prevent="this.$router.push('/auth/login')"
          />
          <div :hidden="!userData">
            <button @click.prevent="toggleMenu" class="flex items-center gap-2">
              <div class="mr-2">
                <img
                  class="w-10 h-10 rounded-full bg-gray-400 object-contain object-center"
                  src="@/assets/images/misc/photo.png"
                  alt=""
                />
              </div>
              <div class="mr-3 flex items-start flex-col">
                <span class="text-sm truncate w-full">{{
                  userData?.data?.username
                }}</span>
                <span class="text-sm text-gray-400"> Manager </span>
              </div>
              <i class="pi pi-chevron-down text-gray-400 ml-1 font-medium"></i>
            </button>
          </div>
          <Menu
            ref="menu"
            id="overlay_menu"
            :append-to="items.path"
            :model="items"
            :popup="true"
          >
            <template #start>
              <button class="w-full cursor-default flex items-center p-2 pl-3">
                <Avatar
                  label="P"
                  size="small"
                  class="mr-2 w-10 h-10"
                  shape="circle"
                />
                <div class="flex flex-col items-start">
                  <span class="font-medium truncate text-left w-3/5 text-sm">{{
                    userData?.data?.username
                  }}</span>
                  <span
                    class="text-sm truncate w-3/5 text-gray-400 font-light"
                    >{{ userData?.data?.email }}</span
                  >
                </div>
              </button>
            </template>
            <template #end>
              <button
                @click.prevent="logoutUser"
                class="w-full flex align-items-center text-sm p-2 pl-5 text-red-500"
              >
                <i class="pi pi-sign-out" />
                <span class="ml-2">Log Out</span>
              </button>
            </template>
          </Menu>
        </div>
      </div>
      <!--under section-->
      <div class="hidden xl:block py-2 bg-white border-b">
        <div class="flex items-center justify-between shape">
          <ul class="flex items-center gap-8">
            <li>
              <a class="flex gap-2">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                >
                  <path
                    d="M3 18H21V16H3V18ZM3 13H21V11H3V13ZM3 6V8H21V6H3Z"
                    fill="#1C1C1C"
                  />
                </svg>
                <span
                  class="text-gray-900 cursor-pointer text-md"
                  @click="toggleCategories"
                  >All category</span
                >
              </a>
              <Menu
                ref="categories"
                id="overlay_menu"
                :model="categories"
                :popup="true"
              />
            </li>
            <li v-for="link in links" :key="link">
              <a class="flex gap-2 cursor-pointer">
                <span class="text-gray-900 text-md">
                  <router-link
                    :to="`${link.path}`"
                    :class="`flex items-center pl-3 py-3 pr-4 rounded ${
                      link.activeName.includes($route.name)
                        ? 'text-white primary'
                        : ''
                    }`"
                    >{{ link.name }}</router-link
                  >
                  >
                </span>
              </a>
            </li>
          </ul>
          <div class="gap-6 flex">
            <div class="gap-6 flex">
              <div class="flex gap-2 items-center justify-center">
                <span class="text-gray-900 text-md">Ship to:</span>
                <img
                  src="https://cdn.britannica.com/42/5042-004-7FF4ACCA/Flag-Cameroon.jpg"
                  alt="flag"
                  class="w-10 h-8 rounded-md"
                />
              </div>
            </div>

            <Dropdown
              v-model="selectedLanguage"
              :options="languages"
              showClear
              optionLabel="name"
              class="p-inputtext-sm"
              placeholder="English, XAF"
            />
          </div>
        </div>
      </div>
    </nav>
  </div>
</template>

<script>
import Button from "primevue/button";
import Menu from "primevue/menu";
import Dropdown from "primevue/dropdown";
import Avatar from "primevue/avatar";
import { storageService } from "@/services";
export default {
  components: { Button, Menu, Avatar, Dropdown },
  name: "HeaderComponent",
  computed: {
    userData() {
      return this.$store.getters.getUserState;
    },
  },
  methods: {
    toggle() {
      console.log("clicked");
    },
    logoutUser(event) {
      this.$store.dispatch("logUserOut");
      (this.userData = null), this.$refs.menu.toggle(event);
    },
    toggleMenu(event) {
      this.$refs.menu.toggle(event);
    },
    toggleCategories(event) {
      this.$refs.categories.toggle(event);
    },
  },
  beforeMount() {
    const user = this.$store.getters.getUserState;
    if (!user) {
      this.$store.dispatch(
        "getCurrentUser",
        storageService.get("MIGRATEAUSTRIALIA_USER_INFO", true)
      );
    }
  },
  data() {
    return {
      links: [
        { name: "Home", path: "/home", activeName: ["main"] },
        { name: "Shop", path: "/products", activeName: ["products"] },
        { name: "About", path: "/about", activeName: ["about"] },
        { name: "Contact us", path: "/contact", activeName: ["contact"] },
        { name: "Blogs", path: "/blog", activeName: ["blog"] },
        { name: "FAQ", path: "/faq", activeName: ["faq"] },
      ],
      items: [
        { separator: true },
        { label: "Profile", icon: "pi pi-fw pi-user", path: "/" },
        { label: "Messages", icon: "pi pi-fw pi-comment", path: "" },
        { label: "Orders", icon: "pi pi-fw pi-heart", path: "/" },
        {
          label: "Cart",
          icon: "pi pi-fw pi-shopping-cart",
          path: "/products/cart",
        },
        { separator: true },
      ],
      categories: [
        { label: "Automobiles" },
        { label: "Clothes and wears" },
        { label: "Home interior" },
        { label: "Computer and Tech" },
        { label: "Sports and Outdoor" },
        { label: "Tools and Equipment" },
        { label: "Animals and Pets" },
        { label: "Machinery Tools" },
      ],
      selectedLanguage: { name: "English, XAF", code: "En" },
      languages: [
        { name: "English, XAF", code: "En" },
        { name: "French, XAF", code: "Fr" },
      ],
    };
  },
};
</script>
